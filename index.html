<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acesso Exclusivo</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .gradient-bg {
            background-color: #111827;
            background-image: radial-gradient(at 47% 33%, hsl(203.00, 39%, 25%) 0, transparent DRAFT), 
                              radial-gradient(at 82% 65%, hsl(289.00, 39%, 25%) 0, transparent DRAFT);
        }
        .glow-on-hover {
            box-shadow: 0 0 5px #e879f9, 0 0 10px #e879f9, 0 0 15px #e879f9;
        }
        .map-preview-container {
            position: relative;
            border-radius: 0.5rem;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .map-preview-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .map-preview-container .overlay {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
    </style>
</head>
<body class="gradient-bg text-gray-200 min-h-screen flex items-center justify-center p-4">

    <div id="loading-spinner" class="text-center">
        <svg class="animate-spin h-10 w-10 text-pink-400 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        <p class="mt-4 text-lg font-medium">A personalizar a sua experiência...</p>
    </div>

    <main id="main-content" class="hidden w-full max-w-4xl mx-auto bg-gray-900/50 backdrop-blur-xl rounded-2xl shadow-2xl shadow-black/50 overflow-hidden">
        
        <div id="pre-payment-view">
            <div class="grid grid-cols-1 md:grid-cols-2">
                <div class="p-6 md:p-8">
                    <img id="model-main-image" src="" alt="Foto da modelo" class="rounded-lg w-full h-auto object-cover aspect-[3/4] shadow-lg">
                    <div class="mt-6">
                        <div class="flex items-center justify-between">
                            <h1 id="model-name" class="text-3xl font-bold text-white"></h1>
                            <span class="bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full flex items-center">
                                <i data-lucide="check-circle" class="w-4 h-4 mr-1"></i> Perfil Verificado
                            </span>
                        </div>
                        <p id="model-location" class="text-lg text-pink-400 font-semibold mt-1"></p>
                        <div class="flex items-center text-yellow-400 mt-2">
                            <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                            <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                            <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                            <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                            <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                            <span id="model-reviews" class="text-gray-300 ml-2 text-sm"></span>
                        </div>
                        <p id="model-bio" class="mt-4 text-gray-300 leading-relaxed"></p>
                    </div>
                </div>

                <div class="p-6 md:p-8 bg-gray-900/70 flex flex-col justify-center">
                    <h2 class="text-2xl font-bold text-white">Acesso VIP à Juliana</h2>
                    <p class="text-gray-400 mt-2">Pague uma única vez para ter acesso vitalício ao conteúdo privado da Juliana e muito mais.</p>
                    
                    <div class="mt-6 bg-gray-800 p-6 rounded-lg">
                        <div class="flex justify-between items-center text-lg">
                            <span class="font-medium text-gray-300">Pagamento Único</span>
                            <span id="model-price" class="font-bold text-2xl text-pink-400"></span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Pagamento seguro processado pela Stripe. Os seus dados estão protegidos.</p>
                        
                        <a id="stripe-link" href="https://buy.stripe.com/4gw16Xa1K6rm12wfZ9" target="_blank" class="block w-full text-center bg-pink-600 text-white font-bold py-4 px-6 rounded-lg mt-6 text-lg hover:bg-pink-700 transition-all duration-300 transform hover:scale-105 glow-on-hover">
                            Liberar Conteúdo por € 13
                        </a>
                         <button id="simulate-payment-btn" class="w-full text-center bg-gray-600 text-white font-bold py-2 px-4 rounded-lg mt-4 text-sm hover:bg-gray-700 transition-colors">
                            (Simular Confirmação de Pagamento)
                        </button>
                    </div>

                    <div class="mt-6">
                        <h3 class="font-semibold text-white mb-4">O que o seu pagamento desbloqueia:</h3>
                        <ul class="space-y-3">
                             <li id="blurred-map-container" class="flex items-start text-green-400 space-x-3">
                                <i data-lucide="map-pin" class="w-5 h-5 mt-1 flex-shrink-0"></i>
                                <div class="flex-grow">
                                    <span class="font-medium">Pré-visualização da Localização</span>
                                    <div class="map-preview-container mt-2 h-24">
                                        <img src="https://placehold.co/300x150/1f2937/4b5563?text=+" alt="Mapa desfocado">
                                        <div class="overlay bg-black/60 backdrop-blur-md">
                                             <i data-lucide="map-pin" class="w-8 h-8 text-red-500"></i>
                                            <p id="map-location-text" class="font-bold text-white"></p>
                                            <p class="text-xs text-gray-400 font-mono">Endereço Exato [BLOQUEADO]</p>
                                        </div>
                                    </div>
                                </div>
                            </li>
                            <li class="flex items-center text-green-400"><i data-lucide="image" class="w-5 h-5 mr-3"></i><span class="font-medium">Galeria de Fotos e Vídeos</span><span class="ml-auto text-gray-500 font-mono">[BLOQUEADO]</span></li>
                            <li class="flex items-center text-yellow-400 border-t border-gray-700 pt-3 mt-3"><i data-lucide="gift" class="w-5 h-5 mr-3"></i><span class="font-bold">BÓNUS: Acesso a +1.000 Perfis</span><span class="ml-auto text-yellow-400 font-mono">[INCLUÍDO]</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="post-payment-view" class="hidden p-8">
             <div class="text-center mb-8">
                <i data-lucide="party-popper" class="w-16 h-16 text-green-400 mx-auto"></i>
                <h2 class="text-3xl font-bold text-white mt-4">Acesso Liberado!</h2>
                <p class="text-gray-300 text-lg mt-2">Aqui está o conteúdo da Juliana. Lembre-se, o seu passe também desbloqueou todos os outros perfis!</p>
            </div>
            <div class="bg-gray-800 p-6 rounded-lg mb-8">
                 <h3 class="text-xl font-semibold text-pink-400 flex items-center mb-4"><i data-lucide="map-pin" class="w-6 h-6 mr-3"></i>Endereço de <span id="unlocked-model-name" class="ml-2"></span></h3>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
                    <div class="map-preview-container h-48">
                         <img src="https://placehold.co/400x300/4299e1/FFFFFF?text=Mapa+N%C3%ADtido" alt="Mapa nítido da localização">
                         <div class="overlay bg-transparent">
                            <i data-lucide="map-pin" class="w-10 h-10 text-red-500 drop-shadow-lg"></i>
                         </div>
                    </div>
                    <p id="unlocked-address" class="text-lg text-white font-mono bg-gray-900 p-4 rounded h-full"></p>
                 </div>
            </div>
            <div class="mb-12">
                <h3 class="text-xl font-semibold text-pink-400 mb-4 flex items-center"><i data-lucide="camera" class="w-6 h-6 mr-3"></i>Galeria Exclusiva de <span id="unlocked-gallery-name" class="ml-2"></span></h3>
                <div id="unlocked-gallery" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
            </div>
            <div class="mt-12">
                <h3 class="text-2xl font-bold text-white mb-6 text-center"><i data-lucide="users" class="w-8 h-8 mx-auto mb-2 text-yellow-400"></i>Navegue por outros perfis na sua região</h3>
                <div id="other-models-list" class="space-y-4"></div>
            </div>
        </div>
    </main>

    <script>
        // --- CONFIGURAÇÃO DA API ---
        const API_BASE_URL = 'https://novaapi-one.vercel.app/api';
        const SELLER_API_KEY = 'SUA_CHAVE_API_DE_VENDEDOR_AQUI'; // Ex: 'a1b2c3d4-...'
        const CHECKOUT_ID = 1; // O ID do checkout que criou no seu painel.

        // --- DADOS MOCKADOS (SIMULANDO UM BANCO DE DADOS) ---
        const mockModelData = {
            name: 'Juliana, 24',
            location: 'sua cidade',
            bio: 'Universitária, apaixonada por conversas inteligentes e momentos inesquecíveis. Adoro arte, vinhos e explorar novos lugares. Vamos criar memórias juntos?',
            price: '€ 13,00',
            reviews: '28 Avaliações',
            mainImage: 'https://placehold.co/600x800/2D3748/E9D8FD?text=Juliana',
            address: 'Rua das Flores Secretas, 123 - Centro\n(Apto 45 - Interfone: 1234)',
            gallery: ['https://placehold.co/400x400/C53030/FFFFFF?text=Foto+1','https://placehold.co/400x400/2C5282/FFFFFF?text=Foto+2','https://placehold.co/400x400/2F855A/FFFFFF?text=Foto+3','https://placehold.co/400x400/805AD5/FFFFFF?text=V%C3%ADdeo+1','https://placehold.co/400x400/D69E2E/FFFFFF?text=Foto+4','https://placehold.co/400x400/DD6B20/FFFFFF?text=Foto+5'],
            otherModels: [
                { name: 'Mariana B.', distance: 'a 6 km de (cidade)', image: 'https://placehold.co/80x80/718096/E2E8F0?text=Mariana' },
                { name: 'Carla S.', distance: 'a 8 km de (cidade)', image: 'https://placehold.co/80x80/B794F4/2D3748?text=Carla' },
                { name: 'Fernanda L.', distance: 'a 12 km de (cidade)', image: 'https://placehold.co/80x80/F56565/4A5568?text=Fernanda' },
                { name: 'Sofia M.', distance: 'a 15 km de (cidade)', image: 'https://placehold.co/80x80/48BB78/1A202C?text=Sofia' }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            let clickId = null;

            const initializePage = async () => {
                let userLocation = { city: 'sua cidade', region: '' };

                try {
                    // 1. Registar o clique na sua API para tracking
                    const registerResponse = await fetch(`${API_BASE_URL}/registerClick`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            sellerApiKey: SELLER_API_KEY,
                            checkoutId: CHECKOUT_ID,
                            user_agent: navigator.userAgent
                        })
                    });
                    if (registerResponse.ok) {
                        const registerData = await registerResponse.json();
                        clickId = registerData.click_id;
                        console.log('Clique registado com sucesso. ID:', clickId);
                    } else {
                         console.warn('Falha ao registar o clique na sua API.');
                    }
                    
                    // 2. Obter localização diretamente do navegador para garantir que funcione
                    const geoResponse = await fetch('https://ipapi.co/json/');
                    if(geoResponse.ok) {
                        const geoData = await geoResponse.json();
                        if (geoData.city) {
                           userLocation = { city: geoData.city, region: geoData.region_code };
                        }
                    } else {
                        console.warn('Não foi possível obter a localização pela API do navegador.');
                    }
                    
                } catch (error) {
                    console.error("Erro durante a inicialização:", error);
                } finally {
                    populateUI(mockModelData, userLocation);
                    populateModelsList('other-models-preview-list', mockModelData.otherModels, userLocation, true);
                    document.getElementById('loading-spinner').classList.add('hidden');
                    document.getElementById('main-content').classList.remove('hidden');
                }
            };

            const unlockContent = () => {
                const model = mockModelData;
                const locationText = document.getElementById('model-location').textContent;
                
                document.getElementById('unlocked-model-name').textContent = model.name;
                document.getElementById('unlocked-gallery-name').textContent = model.name;
                
                const fullAddress = `${model.address}, ${locationText}`;
                document.getElementById('unlocked-address').innerText = fullAddress;

                const galleryContainer = document.getElementById('unlocked-gallery');
                galleryContainer.innerHTML = '';
                model.gallery.forEach(url => {
                    galleryContainer.innerHTML += `<img src="${url}" alt="Conteúdo exclusivo" class="rounded-lg w-full h-auto object-cover aspect-square shadow-md">`;
                });
                
                populateModelsList('other-models-list', model.otherModels, {city: locationText.split(',')[0].trim()}, false);

                document.getElementById('pre-payment-view').classList.add('hidden');
                document.getElementById('post-payment-view').classList.remove('hidden');
                window.scrollTo(0, 0);
            };

            const populateUI = (model, location) => {
                document.getElementById('model-main-image').src = model.mainImage;
                document.getElementById('model-name').textContent = model.name;
                const locationString = `${location.city}, ${location.region || ''}`.replace(/, $/,'');
                document.getElementById('model-location').textContent = locationString;
                document.getElementById('map-location-text').textContent = location.city;
                document.getElementById('model-reviews').textContent = `(${model.reviews})`;
                document.getElementById('model-bio').textContent = model.bio;
                document.getElementById('model-price').textContent = model.price;
            };
            
            const populateModelsList = (containerId, models, location, isLocked) => {
                const listContainer = document.getElementById(containerId);
                listContainer.innerHTML = '';
                const city = location.city || 'sua cidade';

                models.forEach(model => {
                    const actionButton = isLocked 
                        ? `<span class="bg-gray-700 text-gray-400 text-xs font-semibold py-2 px-3 rounded-lg flex items-center whitespace-nowrap"><i data-lucide="lock" class="w-3 h-3 mr-1.5"></i> Bloqueado</span>`
                        : `<a href="#" class="bg-pink-600 text-white font-semibold py-2 px-5 rounded-lg hover:bg-pink-700">Ver Perfil</a>`;
                    const imageSize = isLocked ? "w-12 h-12" : "w-16 h-16";
                    const textSize = isLocked ? "text-base" : "text-lg";

                    listContainer.innerHTML += `
                        <div class="${isLocked ? 'bg-gray-800/50 p-3' : 'bg-gray-800 p-4 hover:bg-gray-700'} rounded-lg flex items-center justify-between transition-colors">
                            <div class="flex items-center overflow-hidden">
                                <img src="${model.image}" alt="Foto de ${model.name}" class="${imageSize} rounded-full object-cover mr-3 flex-shrink-0">
                                <div class="overflow-hidden">
                                    <h4 class="font-bold ${textSize} text-white truncate">${model.name}</h4>
                                    <p class="text-xs text-gray-400">${model.distance.replace('(cidade)', city)}</p>
                                </div>
                            </div>
                            ${actionButton}
                        </div>`;
                });
                lucide.createIcons();
            };

            document.getElementById('simulate-payment-btn').addEventListener('click', unlockContent);
            
            initializePage();
            lucide.createIcons();
        });
    </script>
</body>
</html>

